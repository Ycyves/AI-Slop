<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atom Builder Game</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }
        #game {
            width: 800px;
            margin: 0 auto;
        }
        .element {
            font-size: 28px;
            margin: 20px 0;
            color: #333;
        }
        #buckets {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
        }
        .bucket {
            border: 2px solid #333;
            width: 200px;
            padding: 10px;
            background: #f9f9f9;
        }
        .bucket h3 {
            margin: 0 0 10px 0;
            font-size: 16px;
        }
        .particles {
            height: 300px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-content: flex-start;
        }
        .particle {
            width: 15px;
            height: 15px;
            margin: 2px;
            border-radius: 50%;
            cursor: move;
        }
        .proton {
            background: red;
        }
        .neutron {
            background: gray;
        }
        .electron {
            background: blue;
        }
        .atom-zone {
            position: relative;
            width: 400px;
            height: 400px;
            border: 2px solid #333;
            margin: 20px auto;
            background: #fff;
            display: inline-block;
            vertical-align: top;
        }
        .cross {
            position: absolute;
            left: 200px;
            top: 200px;
            width: 0;
            height: 0;
            z-index: 10;
        }
        .cross::before {
            content: '';
            position: absolute;
            width: 20px;
            height: 2px;
            background: black;
            left: -10px;
            top: -1px;
        }
        .cross::after {
            content: '';
            position: absolute;
            width: 2px;
            height: 20px;
            background: black;
            left: -1px;
            top: -10px;
        }
        .shells {
            position: absolute;
            left: 200px;
            top: 200px;
            transform: translate(-50%, -50%);
            border: 1px dashed gray;
            border-radius: 50%;
            z-index: 1;
        }
        .nucleus {
            position: absolute;
            left: 200px;
            top: 200px;
            transform: translate(-50%, -50%);
            border: 1px solid #666;
            border-radius: 50%;
            background: rgba(100,100,100,0.3);
            z-index: 2;
        }
    </style>
</head>
<body>
    <div id="game">
        <div id="buckets">
            <div class="bucket">
                <h3>Protons</h3>
                <div class="particles" id="p-bucket"></div>
            </div>
            <div class="bucket">
                <h3>Neutrons</h3>
                <div class="particles" id="n-bucket"></div>
            </div>
            <div class="bucket">
                <h3>Electrons</h3>
                <div class="particles" id="e-bucket"></div>
            </div>
        </div>

        <h1 class="element" id="element1">No Element</h1>
        <div id="atom-zone1" class="atom-zone" ondrop="drop(event,1)" ondragover="allowDrop(event)">
            <div class="cross"></div>
            <div id="nucleus1" class="nucleus"></div>
            <div id="shell1_1" class="shells"></div>
            <div id="shell2_1" class="shells"></div>
            <div id="shell3_1" class="shells"></div>
        </div>

        <h1 class="element" id="element2">No Element</h1>
        <div id="atom-zone2" class="atom-zone" ondrop="drop(event,2)" ondragover="allowDrop(event)">
            <div class="cross"></div>
            <div id="nucleus2" class="nucleus"></div>
            <div id="shell1_2" class="shells"></div>
            <div id="shell2_2" class="shells"></div>
            <div id="shell3_2" class="shells"></div>
        </div>
    </div>

    <script>
        const elements = {
            1: 'Hydrogen',
            2: 'Helium',
            3: 'Lithium',
            4: 'Beryllium',
            5: 'Boron',
            6: 'Carbon',
            7: 'Nitrogen',
            8: 'Oxygen',
            9: 'Fluorine',
            10: 'Neon',
            11: 'Sodium',
            12: 'Magnesium',
            13: 'Aluminium',
            14: 'Silicon',
            15: 'Phosphorus',
            16: 'Sulfur',
            17: 'Chlorine',
            18: 'Argon',
            19: 'Potassium',
            20: 'Calcium',
            21: 'Scandium',
            22: 'Titanium',
            23: 'Vanadium',
            24: 'Chromium',
            25: 'Manganese',
            26: 'Iron',
            27: 'Cobalt',
            28: 'Nickel',
            29: 'Copper',
            30: 'Zinc'
        };

        let protons = [0, 0];
        let neutrons = [0, 0];
        let electrons = [0, 0];

        // Populate buckets with 30 of each
        for (let i = 0; i < 30; i++) {
            // Protons
            let p = document.createElement('div');
            p.id = 'p' + i;
            p.className = 'particle proton';
            p.draggable = true;
            p.ondragstart = drag;
            document.getElementById('p-bucket').appendChild(p);

            // Neutrons
            let n = document.createElement('div');
            n.id = 'n' + i;
            n.className = 'particle neutron';
            n.draggable = true;
            n.ondragstart = drag;
            document.getElementById('n-bucket').appendChild(n);

            // Electrons
            let e = document.createElement('div');
            e.id = 'e' + i;
            e.className = 'particle electron';
            e.draggable = true;
            e.ondragstart = drag;
            document.getElementById('e-bucket').appendChild(e);
        }

        function drag(ev) {
            ev.dataTransfer.setData("text", ev.target.id);
        }

        function allowDrop(ev) {
            ev.preventDefault();
        }

        function drop(ev, zoneId) {
            ev.preventDefault();
            const id = ev.dataTransfer.getData("text");
            const dragged = document.getElementById(id);
            const atomZone = document.getElementById(`atom-zone${zoneId}`);

            const index = zoneId - 1;

            if (dragged.classList.contains('proton')) {
                protons[index]++;
                placeNearCenter(dragged);
                updateElement(zoneId);
                updateShells(zoneId);
                updateNucleusPositions(zoneId);
                updateNucleusSize(zoneId);
            } else if (dragged.classList.contains('neutron')) {
                neutrons[index]++;
                placeNearCenter(dragged);
                updateNucleusPositions(zoneId);
                updateNucleusSize(zoneId);
            } else if (dragged.classList.contains('electron')) {
                electrons[index]++;
                placeInShell(dragged);
                updateElectronPositions(zoneId);
            }

            // Remove from original parent and append to atom zone
            dragged.parentNode.removeChild(dragged);
            atomZone.appendChild(dragged);
        }

        function placeNearCenter(el) {
            el.style.position = 'absolute';
            el.style.width = '6px';
            el.style.height = '6px';
            el.style.borderRadius = '50%';
            el.style.left = '197px';
            el.style.top = '197px';
            el.style.margin = '0';
        }

        function placeInShell(el) {
            el.style.position = 'absolute';
            el.style.width = '5px';
            el.style.height = '5px';
            el.style.borderRadius = '50%';
            el.style.left = '197.5px';
            el.style.top = '197.5px';
            el.style.margin = '0';
        }

        function setPos(el, x, y, half = 2.5) {
            el.style.left = (x - half) + 'px';
            el.style.top = (y - half) + 'px';
        }

        function updateElement(zoneId) {
            const index = zoneId - 1;
            const el = document.getElementById(`element${zoneId}`);
            const p = protons[index];
            if (p in elements) {
                el.innerHTML = elements[p];
            } else {
                el.innerHTML = `Element ${p}`;
            }
        }

        function updateShells(zoneId) {
            const index = zoneId - 1;
            const p = Math.max(1, protons[index]);
            const scale1 = Math.pow(p, -0.6);
            const scale2 = Math.pow(p, -0.4);
            const scale3 = Math.pow(p, -0.3);
            const r1 = 50 * scale1;
            const r2 = 150 * scale2;
            const r3 = 250 * scale3;
            const shell1 = document.getElementById(`shell1_${zoneId}`);
            const shell2 = document.getElementById(`shell2_${zoneId}`);
            const shell3 = document.getElementById(`shell3_${zoneId}`);
            shell1.style.width = (2 * r1) + 'px';
            shell1.style.height = (2 * r1) + 'px';
            shell2.style.width = (2 * r2) + 'px';
            shell2.style.height = (2 * r2) + 'px';
            shell3.style.width = (2 * r3) + 'px';
            shell3.style.height = (2 * r3) + 'px';
        }

        function updateNucleusSize(zoneId) {
            const index = zoneId - 1;
            const nucleons = protons[index] + neutrons[index];
            const size = Math.max(10, 10 + Math.sqrt(nucleons) * 5);
            const nucleus = document.getElementById(`nucleus${zoneId}`);
            nucleus.style.width = size + 'px';
            nucleus.style.height = size + 'px';
        }

        function updateNucleusPositions(zoneId) {
            const index = zoneId - 1;
            const nuc_els = document.querySelectorAll(`#atom-zone${zoneId} .proton, #atom-zone${zoneId} .neutron`);
            const nucleons = protons[index] + neutrons[index];
            const nuc_radius = Math.max(5, 3 + Math.sqrt(nucleons) * 2);
            for (let i = 0; i < nuc_els.length; i++) {
                const angle = Math.random() * 2 * Math.PI;
                const r = Math.random() * nuc_radius;
                const x = 200 + r * Math.cos(angle);
                const y = 200 + r * Math.sin(angle);
                setPos(nuc_els[i], x, y, 3);
            }
        }

        function updateElectronPositions(zoneId) {
            const index = zoneId - 1;
            const numElectrons = electrons[index];
            if (numElectrons === 0) return;

            const els = document.querySelectorAll(`#atom-zone${zoneId} .electron`);
            const shell1 = document.getElementById(`shell1_${zoneId}`);
            const shell2 = document.getElementById(`shell2_${zoneId}`);
            const shell3 = document.getElementById(`shell3_${zoneId}`);
            const radius1 = shell1.offsetWidth / 2;
            const radius2 = shell2.offsetWidth / 2;
            const radius3 = shell3.offsetWidth / 2;

            const max1 = 2;
            const max2 = 8;
            const inShell1 = Math.min(numElectrons, max1);
            const inShell2 = Math.min(Math.max(0, numElectrons - max1), max2);
            const inShell3 = Math.max(0, numElectrons - max1 - max2);

            let idx = 0;

            // Shell 1
            for (let i = 0; i < inShell1; i++) {
                let angle = 0;
                if (inShell1 > 1) {
                    angle = 2 * Math.PI * i / inShell1;
                }
                angle += (Math.random() * 0.2 - 0.1);
                const r = radius1 * (0.9 + Math.random() * 0.2);
                const x = 200 + r * Math.cos(angle);
                const y = 200 + r * Math.sin(angle);
                setPos(els[idx], x, y);
                idx++;
            }

            // Shell 2
            for (let i = 0; i < inShell2; i++) {
                let angle = 0;
                if (inShell2 > 1) {
                    angle = 2 * Math.PI * i / inShell2;
                }
                angle += (Math.random() * 0.2 - 0.1);
                const r = radius2 * (0.9 + Math.random() * 0.2);
                const x = 200 + r * Math.cos(angle);
                const y = 200 + r * Math.sin(angle);
                setPos(els[idx], x, y);
                idx++;
            }

            // Shell 3
            for (let i = 0; i < inShell3; i++) {
                let angle = 0;
                if (inShell3 > 1) {
                    angle = 2 * Math.PI * i / inShell3;
                }
                angle += (Math.random() * 0.2 - 0.1);
                const r = radius3 * (0.9 + Math.random() * 0.2);
                const x = 200 + r * Math.cos(angle);
                const y = 200 + r * Math.sin(angle);
                setPos(els[idx], x, y);
                idx++;
            }
        }

        // Initial setup
        function initZone(zoneId) {
            updateShells(zoneId);
            updateNucleusSize(zoneId);
            updateElement(zoneId);
        }
        initZone(1);
        initZone(2);
    </script>
</body>
</html>
